"use strict";!function(e){var t=function(){return{restrict:"AE",scope:{ngModel:"=?",highlightDays:"=?",dayClick:"=?",dayHover:"=?",month:"=?",monthChanged:"=?",weekDaysOff:"=?",allDaysOff:"=?",daysAllowed:"=?",sundayFirstDay:"=?",disallowBackPastMonths:"=?",disallowGoFuturMonths:"=?",showDaysOfSurroundingMonths:"=?",cssDaysOfSurroundingMonths:"=?",fireEventsForDaysOfSurroundingMonths:"=?",disableDaysBefore:"=?",disableDaysAfter:"=?"},template:'\n<div class="multiple-date-picker">\n    <div class="picker-top-row">\n        <div class="text-center picker-navigate picker-navigate-left-arrow"\n             ng-class="{\'disabled\':disableBackButton}" ng-click="previousMonth()">&lt;</div>\n        <div class="text-center picker-month">{{month.format(\'MMMM YYYY\')}}</div>\n        <div class="text-center picker-navigate picker-navigate-right-arrow"\n             ng-class="{\'disabled\':disableNextButton}" ng-click="nextMonth()">&gt;</div>\n    </div>\n  <div class="picker-days-week-row">\n    <div class="text-center" ng-repeat="day in daysOfWeek">{{day}}</div>\n  </div>\n  <div class="picker-days-row">\n    <div class="text-center\n                picker-day\n                {{!day.mdp.otherMonth || showDaysOfSurroundingMonths ? day.css : \'\'}}\n                {{day.mdp.otherMonth ? cssDaysOfSurroundingMonths : \'\'}}"\n         title="{{day.title}}"\n         ng-repeat="day in days"\n         ng-click="toggleDay($event, day)"\n         ng-mouseover="hoverDay($event, day)"\n         ng-mouseleave="dayHover($event, day)"\n         ng-class="{\n            \'picker-selected\': day.mdp.selected,\n            \'picker-off\':!day.selectable,\n            \'today\':day.mdp.today,\n            \'past\':day.mdp.past,\n            \'future\':day.mdp.future,\n            \'picker-other-month\':day.mdp.otherMonth\n          }">\n          {{day ? day.mdp.otherMonth && !showDaysOfSurroundingMonths ? \'&nbsp;\' : day.date.format(\'D\') : \'\'}}\n\n          <div ng-if="day.annotation !== null" class="annotation">\n            {{day.annotation}}\n          </div>\n    </div>\n  </div>\n</div>',link:function(t){t.ngModel=t.ngModel||[];var n=function(){var e=moment(),n=moment(t.month).subtract(1,"month"),a=moment(t.month).add(1,"month");t.disableBackButton=t.disallowBackPastMonths&&e.isAfter(n,"month"),t.disableNextButton=t.disallowGoFuturMonths&&e.isBefore(a,"month")},a=function(){for(var e=moment().localeData()._weekdaysMin,n=[],a=1;7>a;a++)n.push(e[a]);return t.sundayFirstDay?n.splice(0,0,e[0]):n.push(e[0]),n};t.$watch("ngModel",function(){t.generate()},!0),t.$watch("highlightDays",function(){t.generate()},!0),t.$watch("weekDaysOff",function(){t.generate()},!0),t.$watch("allDaysOff",function(){t.generate()},!0),t.$watch("daysAllowed",function(){t.generate()},!0),t.month=t.month||moment().startOf("day"),t.days=[],t.weekDaysOff=t.weekDaysOff||[],t.daysOff=t.daysOff||[],t.disableBackButton=!1,t.disableNextButton=!1,t.daysOfWeek=a(),t.cssDaysOfSurroundingMonths=t.cssDaysOfSurroundingMonths||"picker-empty",t.toggleDay=function(e,n){if(e.preventDefault(),!n.mdp.otherMonth||t.fireEventsForDaysOfSurroundingMonths){var a=!1;e.preventDefault=function(){a=!0},"function"==typeof t.dayClick&&t.dayClick(e,n),n.selectable&&!a&&(n.mdp.selected=!n.mdp.selected,n.mdp.selected?t.ngModel.push(n.date):t.ngModel=t.ngModel.filter(function(e){return!n.date.isSame(e,"day")}))}},t.hoverDay=function(e,n){e.preventDefault();var a=!1;e.preventDefault=function(){a=!0},"function"==typeof t.dayHover&&t.dayHover(e,n),a||(n.mdp.hover="mouseover"===e.type)},t.previousMonth=function(){if(!t.disableBackButton){var e=moment(t.month);t.month=t.month.subtract(1,"month"),"function"==typeof t.monthChanged&&t.monthChanged(t.month,e),t.generate()}},t.nextMonth=function(){if(!t.disableNextButton){var e=moment(t.month);t.month=t.month.add(1,"month"),"function"==typeof t.monthChanged&&t.monthChanged(t.month,e),t.generate()}},t.isDayOff=function(n){return t.allDaysOff||!!t.disableDaysBefore&&moment(n.date).isBefore(t.disableDaysBefore,"day")||!!t.disableDaysAfter&&moment(n.date).isAfter(t.disableDaysAfter,"day")||e.isArray(t.weekDaysOff)&&t.weekDaysOff.some(function(e){return n.date.day()===e})||e.isArray(t.daysOff)&&t.daysOff.some(function(e){return n.date.isSame(e,"day")})||e.isArray(t.daysAllowed)&&!t.daysAllowed.some(function(e){return n.date.isSame(e,"day")})||e.isArray(t.highlightDays)&&t.highlightDays.some(function(e){return n.date.isSame(e.date,"day")&&!e.selectable})},t.isSelected=function(e){return t.ngModel.some(function(t){return e.date.isSame(t,"day")})},t.generate=function(){var a=moment(t.month).date(0).day(t.sundayFirstDay?0:1).subtract(1,"day");moment(t.month).date(0).diff(a,"day")>6&&(a=a.add(1,"week"));var o=moment(t.month).date(1),d=[],s=moment(),i=moment(o).endOf("month"),r=function(){var n={date:moment(a.add(1,"day")),mdp:{selected:!1},annotation:null};if(e.isArray(t.highlightDays)){var o=t.highlightDays.filter(function(e){return n.date.isSame(e.date,"day")});o.length>0?(n.css=o[0].css,n.title=o[0].title,n.annotation=o[0].annotation):(n.css="",n.title="",n.annotation=null)}return n.selectable=!t.isDayOff(n),n.mdp.selected=t.isSelected(n),n.mdp.today=n.date.isSame(s,"day"),n.mdp.past=n.date.isBefore(s,"day"),n.mdp.future=n.date.isAfter(s,"day"),n.date.isSame(t.month,"month")||(n.mdp.otherMonth=!0),n},y=i.diff(a,"days"),l=t.sundayFirstDay?6:0;i.day()!==l&&(y+=(t.sundayFirstDay?6:7)-i.day());for(var f=0;y>f;f++)d.push(r());t.days=d,n()},t.generate()}}};e.module("multipleDatePicker",[]).directive("multipleDatePicker",t)}(window.angular);